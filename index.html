<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>你猜我猜</title>
    <link rel="stylesheet" href="css/style_globle.css">
    <link rel="stylesheet" href="css/jquery.toast.min.css">
    <link rel="icon" href="assets/web_icon.svg">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/3.12.0/tf.min.js"></script>
    <!-- <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script> -->
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="scripts/jquery-3.6.0.min.js"></script>
    <script type="text/javascript"  src="scripts/jquery.toast.min.js"></script>
    <script type="text/javascript"  src="scripts/echarts.js"></script>
    <script type="text/javascript"  src="scripts/lodash.min.js"></script>
</head>

<body>
    <!-- 開始頁面 -->
    <div id='main' style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;">
      <div style="position: absolute; right:20px ; top: 20px; font-size: 30px;  color: white; border: 1px solid white; padding: 5px 10px ; border-radius: 10px;">*建議使用 google chrome 瀏覽器.</div>
       <div id='main_title' class="main_title web" >你猜我畫</div>
        <img class='frame' id='non_intractive' src=assets/frame.svg alt=""></img>
         <div id='main_button' class="main_button">
             <button onclick="language_game(1)">中文</button>
             <!-- <button onclick="language_game(2)">English</button>
             <button onclick="language_game(3)">Portugues</button> -->
         </div>
    </div>

    <!-- 中文簡介 -->
    <div id='introduction_chinese' class="introduction"  >
        <div style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;">
            <div id='main_title' class="main_title web" >在這頁會介紹相關原理跟說明
              讓用戶對數據科學技術有一定了解。
              </div>
            <div id='main_button' class="main_button" style="justify-content: center;">
                <button class='introduction_start' onclick="language_start()">開始</button>
            </div>
        </div>
    </div>

    <!-- 英文簡介 -->
    <div id='introduction_english' class="introduction">
        <div  style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;">
            <div id='main_title' class="main_title web">English</div>
            <div id='main_button' class="main_button" style="justify-content: center;">
                <button class='introduction_start' onclick="language_start()">開始</button>
            </div>
        </div>
    </div>

    <!-- 葡文簡介 -->
    <div id='introduction_portuguese' class="introduction">
        <div  style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;">
            <div id='main_title' class="main_title web" >Portugues</div>
            <div id='main_button' class="main_button" style="justify-content: center;">
                <button class='introduction_start' onclick="language_start()">開始</button>
            </div>
        </div>
    </div>

    <!-- 輸入PIN嗎頁面 -->
    <div id='pin_code' class="pin_code" style='display: none; position: relative;'>
      <div class="game-canvas-delete" onclick="window.location.reload();">
        <img  src="./image/delete.png" alt=""/>
      </div>
        <div  style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;">
          <div
            class="w-full h-full flex flex-col justify-center py-12 sm:px-6 lg:px-8"
          >
            <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
              <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                <div class="mb-4">
                  <div class="flex justify-center">
                    <label
                      class="block text-gray-700 font-medium mb-2 text-lg"
                      for="pinInput"
                    >
                      輸入你的PIN碼
                    </label>
                  </div>
                  <input
                    id="pinInput"
                    class="h-16 text-5xl text-center shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline border-gray-300"
                    type="text"
                    value=""
                  />
                  <div id="pinKeyboard" class="mt-3 grid grid-cols-3 gap-1 hidden">
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      1
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      2
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      3
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      4
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      5
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      6
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      7
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      8
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      9
                    </button>
                    <button
                      class="bg-rose-500 h-10 hover:bg-rose-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      重置
                    </button>
                    <button
                      class="bg-teal-500 h-10 hover:bg-teal-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      0
                    </button>
                    <button
                      class="bg-sky-500 h-10 hover:bg-sky-800 rounded-md m-0.5 text-white text-2xl focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2"
                    >
                      關閉
                    </button>
                  </div>
                </div>
    
                <div class="flex items-center justify-center">
                  <button
                    id="pinStartBtn"
                    class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline h-12 text-xl"
                    type="button"
                  >
                    開始遊戲
                  </button>
                </div>
              </div>
            </div>
            <div class="mt-2 sm:mx-auto sm:w-full sm:max-w-md">
              <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                <div class="flex justify-center">
                  <label
                    class="block text-gray-700 font-medium mb-2 text-lg"
                    htmlFor="username"
                  >
                    或是以新的用戶身份（請使用新用戶開始遊戲）
                  </label>
                </div>
                <div class="flex items-center justify-center">
                  <button
                    id="startDirectlyBtn"
                    class="bg-blue-500 disabled:bg-blue-300 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline h-12 text-xl"
                    type="button"
                  >
                    開始遊戲
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>

    <!-- 卡片頁面 -->
    <div id='round-card' class="cover invisible" >

        <div class='column' style="width: 100%; height: fit-content;align-items: center;">

            <div class='text' style="font-size:50px;margin-bottom: 17px;">
                畫出
            </div>
            <div id='desired_drawing' class='text' style="font-size:100px">
                時鐘
            </div>
            <div class='text' style="font-size:40px;margin-top:17px;">
                繪畫時間 20 秒
            </div>
            <div id='start-btn' class='mainButton start' style="margin-top:52px;" onclick="toggle_game_canvas()">
                開始（5）
            </div>
        </div>
        <!-- <div id='counter' class='text'
            style='position: absolute;width:fit-content;height:fit-content; line-height: 100%;bottom:15px;left:50%;transform: translateX(-50%);'>
            0/6</div> -->
    </div>
    
    <!-- 遊戲頁面 -->
    <div id='game-canvas' class='game-canvas' style='display: none;'>

      <div style="position: absolute; left:50px ; top: 20px; font-size: 30px; color: white; border: 1px solid white; padding: 5px 10px ; border-radius: 10px;">玩法：在畫板中畫出題目的要求</div>

      <div id="game-canvas-reset" class="game-canvas-delete" >
        <img  src="./image/delete.png" alt=""/>
      </div>

      <div class="game-canvas-content"  >
        <div class="game-canvas-content-clip">
            <img src="./image/clip.png" alt=""/>
            <img src="./image/clip.png" alt=""/>
         </div>
         <div style="position: absolute;  height:60px ;background: #FFE363;  top: 20px; left: 20px; right: 20px; opacity: 0.5; z-index: 1;  "></div>
         
         <div id='label' class="label">
            <div class="content" id='inner_desired_drawing' class='text' style='font-size:30px; z-index: 5;'>
                畫出: 時鐘
            </div>
            <div class='timerBox' style=" z-index: 5;">
                <p id='timer'>0:20</p>
            </div>
             <div class="content" style='width: 150px;  z-index: 5;'>分數：<span id='fraction'>0</span></div>
          </div>

          <div style="position: relative;" >
            <div id='prediction'>...</div>
            <canvas id='canvas'></canvas>

            <div class="game-canvas-content-left">
              <div class="game-canvas-content-left-img">
                <img id="game-canvas-content-left-img-src" src="./image/topic/circle.png" alt=""/>
              </div>
              <p >塗鴉：<span id="game-canvas-content-left-number">1</span>/6</p>
            </div>

            <div class="game-canvas-content-right">
              <!-- <div class="game-canvas-content-right-box">
                <img src="./image/pencil.png" alt=""/>
              </div> -->
              <div class="game-canvas-content-right-box" id="rubber" >
                <img src="./image/eraser.png" alt=""/>
              </div>
            </div>
          </div>
      </div>
    </div>

    <!-- 結束頁面 -->
    <div id='end-card' style='display: none;' >
        <div style="width: 100%; height: 100%; background:#4B4453; position: fixed; left:0px;top:0px;z-index: 5;">
          <p class="endP">遊戲結束！</p>
          <p class="endP text-5xl my-4"  >繪畫總分數：<span id='totalScore'>0</span></p>
           <!-- 遊戲得分圖 -->
            <div class="mt-1 sm:mx-auto sm:w-full sm:max-w-md">
              <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                <div id="eChartsMain" style="width: 400px; height: 250px"></div>
              </div>
            </div>
            <div class="mt-2 sm:mx-auto sm:w-full sm:max-w-md">
              <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                <div class="flex justify-center">
                  <label class="block text-gray-700 font-medium mb-1 text-lg">
                    你的用戶PIN碼
                  </label>
                </div>
                <div class="flex justify-center">
                  <label
                    id="showPinLabel"
                    class="py-2 px-3 text-gray-700 shadow text-center text-5xl"
                  >
                  </label>
                </div>
                <div class="flex justify-center">
                  <label class="block text-gray-700 font-medium mt-1 text-sm">
                    請記住這組PIN碼以在其它遊戲使用
                  </label>
                </div>
              </div>
            </div>
            <div id='endButton' class="endButton web" onclick="again()">再來！（10）</div>
        </div>
    </div>

  <script>
          // 測試用，用於修改單個畫面
          // $('#main').hide()
          // $('#game-canvas').css("display", "none")
          // $('#introduction_chinese').css("display", "none")
          // $('#introduction_english').css("display", "none")
          // $('#introduction_portuguese').css("display", "none")
          // $('#pin_code').css("display", "none")
          // $('#round-card').css("display", "none")
          // $('#end-card').css("display", "block")
  </script>

    <script defer type="text/javascript">
        async function load_model() {
            model = await tf.loadLayersModel('./tf_model/model.json');
            //To warmup the model
            const warmupResult = model.predict(tf.zeros([1, 28, 28, 1]));
            warmupResult.dataSync();
            warmupResult.dispose();
        }
        var model;
        var labels;

        $.getJSON("./labels.json", function (raw_labels) {
            labels = raw_labels
        });
        load_model()
    </script>
    <script defer src="scripts/rdp.js"></script>
    <script defer src="scripts/draw.js"></script>
    <script defer src="scripts/transition.js"></script>

</body>

</html>